<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Frame Game Scene</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script>https://unpkg.com/aframe-motion-capture-components@0.1.6/dist/aframe-motion-capture-components.min.js</script>
     <style>
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 36px; /* Increased font size for score */
        }
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 36px; /* Increased font size for game over message */
            display: none; /* Hide game over message by default */
        }
     </style>
    <title>A-Frame Motion Capture</title>
    <meta name="description" content="Motion capture and WebVR recording for A-Frame."></meta>
    <style>
      html {
        background: #33425B;
        color: #FAFAFA;
        font-family: monospace;
        font-size: 20px;
        padding: 10px 20px;
      }
      h1 {
        font-weight: 300;
      }
      a {
        color: #FAFAFA;
        display: block;
        padding: 15px 0;
      }
    </style>
</head>
<body>
    <h1>A-Frame Motion Capture</h1>
    <a href="examples/replay.html">Replay</a>
    <a href="examples/development.html">Development</a>
    <a href="examples/record.html">Record</a>
    <a href="examples/animationTool.html">Animation Tool</a>
    <a href="examples/queryParams.html">Query Parameters</a>
    <a href="examples/queryParams.html?avatar-recording=recordings/grabLeft.json">Query Parameters (Grab Left Recording)</a>
    <a href="examples/queryParams.html?avatar-recording=recordings/grabRight.json">Query Parameters (Grab Right Recording)</a>

    <!-- GitHub Corner. -->
    <a href="https://github.com/dmarcos/aframe-motion-capture-components" class="github-corner">
      <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#222; color:#fff; position: absolute; top: 0; border: 0; right: 0;">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
    <style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}
    </style>
    <a-scene physics="gravity: -9.8">
        <!-- Небо -->
        <a-sky color="#87CEEB"></a-sky>

        <!-- Пол -->
        <a-plane position="0 0 -5" rotation="-90 0 0" width="10" height="10" color="#8B4513" static-body></a-plane>

        <!-- Кубы -->
        <a-box position="-2 2 -3" rotation="0 45 0" width="1" height="1" depth="1" color="#4CC3D2" class="collectible" dynamic-body></a-box>
        <a-box position="2 2 -3" rotation="0 45 0" width="1" height="1" depth="1" color="#EF2D5E" class="collectible" dynamic-body></a-box>

        <!-- Сферы -->
        <a-sphere position="-1 2 -2" radius="0.5" color="#FFC65D" class="collectible" dynamic-body></a-sphere>
        <a-sphere position="1 2 -2" radius="0.5" color="#7BC8A4" class="collectible" dynamic-body></a-sphere>
        <a-sphere position="0 2 -4" radius="0.5" color="#FF6347" class="collectible" dynamic-body></a-sphere>

        <!-- Камера с контроллерами -->
        <a-entity id="camera" camera look-controls wasd-controls="acceleration:100" position="0 1.6 0">
            <a-entity id="leftHand" oculus-touch-controls="hand: left"></a-entity>
            <a-entity id="rightHand" oculus-touch-controls="hand: right"></a-entity>
        </a-entity>

   <!-- Text for displaying score and timer -->
        <a-text id="score-text" value="Score: 0" position="-4 5 -8"></a-text>
        <a-text id="timer-text" value="Timer: 60" position="-4 5 -5"></a-text>
    </a-scene>

    <script>
        let score = 0;
        let timer = 60; // Start timer at 60 seconds
        let gameInterval;

        // Function to update the score on screen
        function updateScoreDisplay() {
            document.getElementById('score-text').setAttribute('value', 'Score: ' + score);
        }

        // Function to update the timer
        function updateTimer() {
            if (timer > 0) {
                timer--;
                document.getElementById('timer-text').setAttribute('value', 'Time Left: ' + timer);
            } else {
                endGame();
            }
        }


        // Функция для обработки столкновения
        function handleCollision(event) {
            const collidedElement = event.detail.body.el;
            if (collidedElement.classList.contains('collectible')) {
                // Увеличиваем счет
                score++;
                document.getElementById('scoreText').setAttribute('value', 'Счет: ' + score);

                // Удаляем объект
                collidedElement.parentNode.removeChild(collidedElement);
            }
        }

        // Добавляем слушатель событий для столкновений
        document.querySelector('a-scene').addEventListener('collide', handleCollision);
    </script>

        // Добавляем слушатель событий для столкновений
        document.querySelector('a-scene').addEventListener('collide', handleCollision);
     function updateTimer() {
            timeLeft--;
            document.getElementById('timerText').setAttribute('value', 'Время: ' + timeLeft);

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                endGame();
            }
        }
        //Добавить физический движок
        <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
        <a-scene physics="debug: true">
        //Добавьте анимацию исчезновения (частицы):
        <a-entity id="explosion" particle-system="preset: explosion; color: yellow"></a-entity>
        //Интегрируйте звук при сборе:
        <a-sound src="v-starom-dome-na-obochine.mp3" autoplay="false" id="collectSound"></a-sound>
        document.querySelector('#collectSound').components.sound.playSound();
        //Добавьте движущиеся объекты с помощью анимации:
        <a-entity id="movingObj" geometry="primitive: cone" material="color: red" 
          position="0 2 -8" animation="property: position; to: 5 2 -8; dur: 2000; loop: true">
        </a-entity>
        //Рандомизируйте позиции при перезапуске:
        function spawnObjects() {
      const positions = [];
      for (let i = 0; i < 5; i++) {    
          const x = Math.random() * 10 - 5;
          const z = Math.random() * 10 - 5;
          positions.push({x, y: 1, z});
  }
  return positions;
}
        //Настройте физику для ваших объектов:
        <a-entity geometry="primitive: box" material="color: blue" 
        position="0 5 -10" dynamic-body></a-entity>
        //Добавьте гравитацию:
        AFRAME.registerComponent('gravity', {
            tick: function () {
            this.el.body.applyForce(0, -9.8, 0);
  }
});



            
        // Функция для завершения игры
        function endGame() {
            clearInterval(gameInterval);
            document.getElementById('gameOverText').setAttribute('value', 'Game over! Score: ' + score);
            document.getElementById('gameOverText').setAttribute('visible', 'true');
            // Отключаем управление
            document.getElementById('camera').setAttribute('wasd-controls', 'enabled: false');
        }
        // Restart game function
        function restartGame() {
            score = 0;
            timer = 60; // Reset timer to 60 seconds
            updateScoreDisplay();
            document.getElementById('timer-text').setAttribute('value', 'Time Left: ' + timer);
            document.getElementById('game-over').style.display = 'none'; // Hide game over message
            
            const collectibles = document.querySelectorAll('.collectible');
            collectibles.forEach(obj => {
                obj.setAttribute('visible', true); // Return objects to the scene
                obj.setAttribute('position', obj.getAttribute('position')); // Ensure they are visible
            });
            
            gameInterval = setInterval(updateTimer, 1000); // Start timer
            updateTimer(); // Start timer immediately
        }
        // Initialize score and timer display
        updateScoreDisplay();
        document.getElementById('timer-text').setAttribute('value', 'Time Left: ' + timer);

        // Запускаем таймер
        timerInterval = setInterval(updateTimer, 1000);
    </script>
</body>
</html>


